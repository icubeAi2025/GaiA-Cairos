<!DOCTYPE html>
<html lang="ko">
<head>
    {% include "sub/head" %}
    {% block head %}{% endblock %}
</head>
<script>
	let param = gaiaPortal.getQueryParams();
	let storageParam = commonJs.getSessionStorage("pageCommonData"); 
	let pjtInfo;
	let normalConn = true;

	if(!storageParam && param.pjtNo && param.cntrctNo) {
		normalConn = false;

		$.ajax({
			url: "/api/portal/select-pjtNm-cntrctNm/"+param.pjtNo+"/"+param.cntrctNo,
			method: "GET",
			contentType: "application/json",
			dataType: "json",
			success: function (data, status, xhr) {
				console.log(data.details?.pjtNmCntrctNm);
				pjtInfo = 	{
								"pjtNo": data.details?.pjtNmCntrctNm.pjt_no,
								"pjt_nm": data.details?.pjtNmCntrctNm.pjt_nm,
								"cntrctNo": data.details?.pjtNmCntrctNm.cntrct_no,
								"cntrct_nm": data.details?.pjtNmCntrctNm.cntrct_nm
							};

				commonJs.setSessionStorage("pageCommonData", pjtInfo);

				gaiaPortal.init(pjtInfo.pjtNo, pjtInfo.pjt_nm, pjtInfo.cntrctNo, pjtInfo.cntrct_nm);
			},
			error: function (xhr) {
				console.error(
					"Error :",
					xhr.responseText
				);
			},
		});
	} else {
		pjtInfo = 	{
						"pjtNo": storageParam.pjtNo,
						"pjt_nm": storageParam.pjt_nm,
						"cntrctNo": storageParam.cntrctNo,
						"cntrct_nm": storageParam.cntrct_nm
					};
	} 
</script>
<body style="display:none">
    {% include "sub/head_content" %}   
    <div class="container">
        <!-- 좌측 메뉴 영역 (Navbar) Start -->
        {% include "sub/nav" %}
        <!-- 좌측 메뉴 영역 (Navbar) End -->
        <div class="content_wrap">            
            <div class="page_header" id="pageNav"></div>
            <!-- 화면 본 컨텐츠 영역 Start -->
            {% block content %}{% endblock %}
            <!-- 화면 본 컨텐츠 영역 End -->
        </div>
		{% include "sub/pop_box" %}
    </div>
    {% block footer_script %}{% endblock %}
</body>
<script>
		if(normalConn) {
			console.log("base_content.peb log : " + JSON.stringify(pjtInfo));
			gaiaPortal.init(pjtInfo.pjtNo, pjtInfo.pjt_nm, pjtInfo.cntrctNo, pjtInfo.cntrct_nm);
		}
</script>
</html>