<!doctype html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Document</title>

    <link type="text/css" rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" />

    <link rel="stylesheet" href="/assets/static/toast/zephyr-toast.css" />
    <link rel="stylesheet" href="/assets/static/toast/zephyr-toast-animate.css" />

    <script src="https://unpkg.com/vue@3.5.21"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!-- Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script type="text/javascript" src="/assets/js/jquery-3.4.1.min.js"></script>

    <script src="/assets/static/toast/zephyr-toast.js"></script>

    <script src="/assets/static/tware/tware.class.js"></script>
    <script src="/assets/js/common/axios.common.js"></script>
    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/gaia_common.js"></script>
    <script src="/assets/js/gaia-cairos.js"></script>


    <!-- 신규 CSS 적용 Start -->
    <link rel="stylesheet" href="/assets/css/common.css" />
    <link rel="stylesheet" href="/assets/css/content.css" />
    <link rel="stylesheet" href="/assets/css/icofonts.css" />
    <link rel="stylesheet" href="/assets/css/pretendard-subset.css" />
    <link rel="stylesheet" href="/assets/css/slick.css" />
    <link rel="stylesheet" href="/assets/css/component.css" />
    <link rel="stylesheet" href="/assets/css/custom.css" />
</head>
<body>
<!-- alert창 -->
<div class="pop_box toast" id="popBoxToast" style="display:none; position:absolute; z-index:50; opacity: 100 !important;">
    <span class="toast_msg"></span>
    <button type="button" class="icon_btn pop_close">
        <i class="ic ic-close"></i>
        <span class="blind">창닫기</span>
    </button>
</div>

<h1>pdf merge download</h1>

<button id="btnDownloadNewWindow" class="btn _fill">download new window</button>
<button id="btnDownload" class="btn _fill">download</button>

<button id="btnDocumentRemove" class="btn _fill">document remove</button>

<script>
    $(() => {
        $('#btnDownloadNewWindow').on('click', function () {
            window.open("/resource/pdf-merge?transactionId=TRAN_PDF_MERGE_SAMPLE&files=D:/1.pdf,D:/2.pdf,D:/3.pdf&path=D:/&name=merge.pdf");
        });

        const query = tware.utils.parseQuery();

        $('#btnDownload').on('click', function () {
            gaiaCommon.getBlob(
                "/resource/pdf-merge",
                query,
                (data, xhr) => {
                    const allHeaders = xhr.getAllResponseHeaders();
                    console.log('모든 헤더:', allHeaders);

                    const contentType = xhr.getResponseHeader('Content-Type');
                    console.log('contentType', contentType)
                    const fileName = xhr.getResponseHeader('X-FILE-NAME');
                    console.log('fileName', fileName)

                    const url = URL.createObjectURL(data);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url); // Clean up the URL object
                }
            );
        });

        $('#btnDocumentRemove').on('click', function () {
            gaiaCommon.post('/webApi/test/delete-doc', {docIds: ['971d09e8-c18c-4a1d-a392-5e0debb10315', '552f160f-d0d8-4e4b-baf8-6c6194d6ebb5']}, (res) => {
                console.log(res);
            });
        });
    });
</script>

</body>
</html>