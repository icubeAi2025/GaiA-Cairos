<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/assets/css/all.min.css" />
    <link rel="stylesheet" href="/assets/css/jstree/themes/default/style.min.css" />
    <link rel="stylesheet" href="/assets/static/tui-pagination/dist/tui-pagination.css" />
    <link rel="stylesheet" href="/assets/static/tui-pagination/dist/tui-pagination.min.css"/>
    <link rel="stylesheet" href="/assets/static/tui-grid/dist/tui-grid.css" />
    <link rel="stylesheet" href="/assets/css/common.css" />
    <link rel="stylesheet" href="/assets/css/content.css" />
    <link rel="stylesheet" href="/assets/css/icofonts.css" />
    <link rel="stylesheet" href="/assets/css/pretendard-subset.css" />
    <link rel="stylesheet" href="/assets/css/slick.css" />
    <link rel="stylesheet" href="/assets/css/component.css" />
    <link rel="stylesheet" href="/assets/css/custom.css" />
    <script src="/assets/js/jquery-3.4.1.min.js"></script>

    <script src="/assets/js/gaia_common.js"></script>
    <script src="/assets/static/tui-pagination/dist/tui-pagination.js"></script>
    <script src="/assets/static/tui-pagination/dist/tui-pagination.min.js"></script>
    <script src="/assets/static/tui-grid/dist/tui-grid.js"></script>
<style>
</style>
</head>
<body>
    <!-- 토스트 메세지 : 활성화:'on'추가, 수초 후 'on'제거-->
    <div class="pop_box toast on" id="popBoxToast" style="display:none;position:absolute;z-index:50">
        <span class="toast_msg">`
        </span>
        <button type="button" class="icon_btn pop_close">
            <i class="ic ic-close"></i>
            <span class="blind">창닫기</span>
        </button>
    </div>


    <div class="alertModal fade" style="z-index:16;">
        <div class="pop_box alert on" id="popBoxAlert" data-name="Alert" style="display:none;">
            <div class="pop_header">
                <h5 class="pop_tit">알림</h5>
                <button type="button" class="icon_btn pop_close">
                    <i class="ic ic-close"></i>
                    <span class="blind">창닫기</span>
                </button>
            </div>
            <div class="pop_body">
                <strong class="msg_tit">이동하시겠습니까?</strong>
                <p class="msg_tit_dlt">다른 페이지로 이동하면 작성 중이던 내용이 모두 삭제됩니다.</p>
            </div>
            <div class="pop_footer">
                <div class="btn_area jc_e">
                    <button type="button" class="btn _outline" id="pop_box_cancle">취소</button>
                    <button type="button" class="btn _fill" id="pop_box_confirm">완료</button>
                </div>
            </div>
        </div>
    </div>

    <div class="alertModal" id="customAlertModal" style="z-index:16;">
        <div class="pop_box alert on _sm" id="customPopBoxAlert" data-name="Alert" style="display:none;">
            <div class="pop_header">
                <h5 class="pop_tit" id="c_pop_tit">알림</h5>
                <button type="button" class="icon_btn pop_close">
                    <i class="ic ic-close"></i>
                    <span class="blind">창닫기</span>
                </button>
            </div>
            <div class="pop_body" id="c_pop_body">

            </div>
            <div class="pop_footer">
                <div class="btn_area jc_e">
                    <button type="button" class="btn _outline" id="c_pop_box_cancle">취소</button>
                    <button type="button" class="btn _fill" id="c_pop_box_confirm">완료</button>
                </div>
            </div>
        </div>
    </div>

    <div class="dateConfirmModal fade" style="z-index:16;">
        <div class="pop_box alert on" id="dateModal" data-name="Alert" style="display:none;">
            <div class="pop_header">
                <h5 class="pop_tit">복사</h5>
                <button type="button" class="icon_btn pop_close">
                    <i class="ic ic-close"></i>
                    <span class="blind">창닫기</span>
                </button>
            </div>
            <div class="pop_body">
                <strong class="msg_tit">날짜 선택</strong>
                <div class="form_data" style="margin-top: 12px; padding:0px; width: max-content;">
                    <input type="date" style="width: 250px;" id="copyDate" class="date" value="">
                </div>
            </div>
            <div class="pop_footer">
                <div class="btn_area jc_e">
                    <button type="button" class="btn _fill" id="date_pop_box_confirm" >복사</button>
                    <button type="button" class="btn _outline" id="data_pop_box_cancle">취소</button>
                </div>
            </div>
        </div>
    </div>












    <div id="grid"></div>
    <button onclick="f()">체크된 행 번호 보기</button>
    <button onclick="rollback()">삭제 문서 롤백</button>
</body>
<script src="/assets/js/custom_renderer.js"></script>
<script>
    const checkedRow = [];
    const grid = new tui.Grid({
        el: document.getElementById('grid'),
        data:[
            {
                rowNum:1,
                single:"매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다.",
                multi:"새 창 아이콘 렌더링 용도의 행",
                sampleData1:"아이콘 너비 빼고 가운데 정렬",
                sampleData2:"전체 크기 기준으로 가운데 정렬",
                numForOpen:10
            },
            {
                rowNum:2,
                single:"단건 렌더링 컬럼의 데이터입니다2",
                multi:"매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. 매우 긴 데이터입니다. ",
                sampleData1:"그래서 이 경우는 내용이 길어도 절대로 겹치지 않지만",
                sampleData2:"이 경우에는 겹칠 수 있으므로 사용 부분에서 컨트롤 필요"
            },
            {
                rowNum:3,
                single:"(single)XSS데이터입니다 &lt;script&gt;alert('Hello');&lt;/script&gt;",
                multi:"(multi)XSS데이터입니다 &gt;_&lt;",
                sampleData1:"샘플 데이터1 입니다.",
                sampleData2:"샘플 데이터2 입니다."
            },
            {
                rowNum:4,
                single:"color 속성으로 아이콘 색상을 변경할 수 있습니다.",
                multi:"렌더러 옵션 배열의 첫 번째 객체에 textColor 속성을 주면 렌더링 되는 글자의 색상을 변경할 수 있습니다.",
                sampleData1:"샘플 데이터1 입니다.",
                sampleData2:"샘플 데이터2 입니다."
            },
            {
                rowNum:5,
                single:"단건 렌더링 컬럼의 데이터입니다5",
                multi:"isBlink 속성을 이용해 아이콘을 깜박이게 할 수 있습니다.",
                sampleData1:"샘플 데이터1 입니다.",
                sampleData2:"샘플 데이터2 입니다."
            },
        ],
        scrollX: true,
        scrollY: true,
        useClientSort: false,
        minBodyHeight:400,
        contextMenu: null,
        rowHeaders: [
            {
                type: 'checkbox',
                width: 120,
                renderer:{
                    type:window.IconRenderer,
                    //맨 앞 열에 렌더러 사용하는 경우
                    //아이콘이 여러개인 경우 아이콘 렌더러 객체 여러개 배열로 제공
                    options:[
                        {
                            // auth가 없으면 무조건 렌더링
                            // auth:true,
                            //type만 넘길시(특히 체크박스) 렌더링만 수행
                            type:'checkBox'
                        },
                        {
                            auth:true,  //렌더링 권한
                            type:'trash',   //종류(아래 예시들 참고)
                            url: '/renderer/trash', //통신이 필요한 경우 url
                            idField:'rowNum',   //통신에 넘겨줄 데이터 컬럼
                            keyName: 'rowNumList',  //백엔드에서 받을 파라미터 명
                            msgList: {  //컨펌창이 필요한 경우 메세지 리스트
                                confirmTit: "삭제 타이틀",
                                confirmSubTit: "삭제 컨펌창 바디의 타이틀",
                                confirmMsg:"삭제 컨펌창 메세지",
                                completeMsg: "삭제 완료 메세지"
                            },
                            //사전 조건 검사 함수
                            condition:function(rowData){
                                //아래는 예시 코드입니다
                                console.log("ROWDATA :", rowData);
                                if(rowData.rowNum === 2){
                                    gaiaCommon.customAlert("2번 데이터는 삭제할 수 없습니다.")
                                    return false;
                                }
                                return true;
                            },
                            //통신 성공시 수행할 함수
                            success:function(rowData) {
                                //사후처리를 위한 rowData 반환 후 콜백
                                console.log("여기는 ajax 통신 성공시 로직 작성111.\nROWDATA :",rowData)
                            },
                            //통신 실패시 수행할 함수
                            fail:function(rowData){
                                //사후처리를 위한 rowData 반환 후 콜백
                                console.log("여기는 ajax 통신 실패시 로직 작성111.\nROWDATA :",rowData)
                            },
                            //통신 완료시 수행할 함수
                            complete:function(rowData){
                                //사후처리를 위한 rowData 반환 후 콜백
                                console.log("여기는 ajax 통신 완료시 로직 작성111.\nROWDATA :",rowData)
                            }
                        },
                        {
                            auth:true,
                            type:'note',
                            url: '/renderer/note',
                            idField:'rowNum',
                            keyName: 'rowNumList',
                            msgList: {
                                confirmTit: "노트 타이틀",
                                confirmSubTit: "노트 컨펌창 바디의 타이틀",
                                completeMsg: "노트 완료 메세지"
                            },
                            //사전 조건 검사 필요 없으면 포함 X
                            // condition:function(rowData){
                            //     return true;
                            // },
                            success:function(rowData) {
                                console.log("여기는 ajax 통신 성공시 로직 작성222.\nROWDATA :",rowData)
                            },
                            fail:function(rowData){
                                console.log("여기는 ajax 통신 실패시 로직 작성222.\nROWDATA :",rowData)
                            },
                            complete:function(rowData){
                                console.log("여기는 ajax 통신 완료시 로직 작성222.\nROWDATA :",rowData)
                            }
                        }
                    ]
                }
            },

        ],
        columns:[
            {
                header: "행번호", // 계정
                name: 'rowNum',
                resizable: true,
                width:40
            },
            {
                header: "단건 렌더링",
                name: 'single',
                align: 'left',
                renderer: {
                    type:window.IconRenderer,
                    options:[
                        {
                            auth:true,
                            type:'copy',
                            url: '/renderer/copy',
                            idFields:'rowNum,single',//통신에 넘겨줄 데이터 컬럼(여러개)
                            keyName: 'rowNumList',
                            color:"red",
                            msgList: {
                                confirmTit: "복사 타이틀",
                                confirmSubTit: "복사 컨펌창 바디의 타이틀",
                                confirmMsg:"복사 컨펌창 메세지",
                                completeMsg: "복사 완료 메세지"
                            },
                            condition:function(rowData){
                                //여기는 사전 조건이 따로 없어서 return true 하고 끝
                                return true;
                            },
                            success:function(rowData) {
                                console.log("여기는 ajax 통신 성공시 로직 작성.\nROWDATA :",rowData)
                            },
                            fail:function(rowData){
                                console.log("여기는 ajax 통신 실패시 로직 작성.\nROWDATA :",rowData)
                            },
                            complete:function(rowData){
                                console.log("여기는 ajax 통신 완료시 로직 작성.\nROWDATA :",rowData)
                            }
                        }
                    ]
                },
                resizable: true
            },
            {
                header: "다건 렌더링", //직급
                name: 'multi',
                align: 'center',
                width:800,
                resizable: true,
                //새 창 열기나 페이지 이동을 하는 경우 option에 open으로 선언
                //그런 경우엔 success 불필요
                renderer:{
                    type:window.IconRenderer,
                    options:[
                        {
                            auth:true,
                            type:'newWindow',
                            open:{
                                url:'/renderer/newWindow/{id1}/{id2}',
                                width: "1300",
                                height: "550",
                                target:'targetPopup',
                                mode:"p",
                                top:100,
                                left:100,
                            },
                            isHover:true,
                            idFields:'rowNum,numForOpen',
                            textColor:"deeppink",
                            condition:function(rowData){
                                if(rowData.rowNum == 2){
                                    alert("2번 행 데이터는 로직을 타지 않습니다.")
                                    return false;
                                }
                                return true;
                            }
                        },
                        {
                            type:'arrowUp',
                            url: '/renderer/up',
                            idField:'rowNum',
                            keyName: 'rowNumList',
                            //align:"right" 이후의 아이콘들은 전부 우측정렬
                            align:"right",
                            msgList: {
                                completeMsg: "완료 메세지2 입니다."
                            },
                            condition:function(rowData){
                                //아래는 예시 코드입니다
                                if(rowData.rowNum == 4){
                                    alert("4번 행 데이터는 로직을 타지 않습니다.")
                                    return false;
                                }
                                return true;
                            },
                            success:function(rowData) {
                                console.log("여기는 ajax 통신 성공시 로직 작성.222\nROWDATA :",rowData)
                            },
                            fail:function(rowData){
                                console.log("여기는 ajax 통신 실패시 로직 작성.222\nROWDATA :",rowData)
                            },
                            complete:function(rowData){
                                console.log("여기는 ajax 통신 완료시 로직 작성.222\nROWDATA :",rowData)
                            }
                        },
                        {
                            type:'arrowDown',
                            url: '/renderer/down',
                            idField:'rowNum',
                            keyName: 'rowNumList',
                            condition:function(rowData){
                                if(rowData.rowNum == 4){
                                    alert("4번 행 데이터는 로직을 타지 않습니다.")
                                    return false;
                                }
                                return true;
                            },
                            success:function(rowData) {
                                console.log("여기는 ajax 통신 성공시 로직 작성.222\nROWDATA :",rowData)
                            },
                            fail:function(rowData){
                                console.log("여기는 ajax 통신 실패시 로직 작성.222\nROWDATA :",rowData)
                            },
                            complete:function(rowData){
                                console.log("여기는 ajax 통신 완료시 로직 작성.222\nROWDATA :",rowData)
                            }
                        },
                        {
                            type:'eyes',
                            url: '/renderer/pdfViewer',
                            idField:'rowNum',
                            keyName: 'rowNumList',
                            isBlink:true,
                            success:function(rowData) {
                                console.log("여기는 ajax 통신 성공시 로직 작성.222\nROWDATA :",rowData)
                            },
                            fail:function(rowData){
                                console.log("여기는 ajax 통신 실패시 로직 작성.222\nROWDATA :",rowData)
                            },
                            complete:function(rowData){
                                console.log("여기는 ajax 통신 완료시 로직 작성.222\nROWDATA :",rowData)
                            }
                        }
                    ]
                }
            },
            {
                header: "absolute 아닌것",
                name: 'sampleData1',
                align: 'center',
                resizable: true,
                renderer:{
                    type:window.IconRenderer,
                    options:[
                        {
                            type:"newWindow",
                            align:"right",
                            absolute:false,
                        }
                    ]
                }
            },
            {
                header: "absolute 인것",
                name: 'sampleData2',
                align: 'center',
                resizable: true,
                renderer:{
                    type:window.IconRenderer,
                    options:[
                        {
                            type:"newWindow",
                            align:"right",
                            absolute:true,
                        }
                    ]
                }
            },
            {
                header:'아이콘 종류',
                name:'type',
                renderer:{
                    type:window.IconRenderer,
                    options:[
                        {
                            type:'pdf'
                        },
                        {
                            type:'printer'
                        },
                        {
                            type:'edit'
                        },
                        {
                            type:'plus'
                        },
                        {
                            type:'setting'
                        },
                        {
                            type:'folderClose'
                        },
                        {
                            type:'folderOpen'
                        },
                        {
                            type:'calendar'
                        },
                        {
                            type:'starempty'
                        },
                        {
                            type:'starfill'
                        },
                    ]
                }
            }
        ],
    });

    function f(){
        const checkedRow = [];

        // 1.
        // const allRows = grid.getData();
        // allRows.forEach(row => {
        //     if (row._attributes.checked) {
        //         const rowNum = row.rowNum;
        //         const sampleData1 = row.sampleData1;
        //         checkedRow.push(rowNum + "(" + sampleData1 + ")");
        //     }
        // });

        //2.
        const checkedRows = grid.getCheckedRows();
        checkedRows.forEach(row => {
            const rowNum = row.rowNum;
            const sampleData1 = row.sampleData1;
            checkedRow.push(rowNum + "(" + sampleData1 + ")");
        })
        alert("체크된 행 : "+checkedRow);

    }

    function rollback(){
        const param = {docIds : ['be0b3df0-5508-4e5d-92f8-8d5d16a3a598', 'd14dafc7-66d7-41e6-a8c9-bbef6c671fdd']};

        gaiaCommon.post('/webApi/test/delete/rollback', param, (res) => {
            console.log(res);
        });
    }
</script>
</html>